{% extends "layout.html" %}
{% block title %}All Books - Admin View{% endblock %}
{% block sidebar %}
  <a href="/dashboard">🏠 Dashboard</a>
  <a href="/upload">📤 Upload Book</a>
  <a href="/manage-books">🛠 Manage Books</a>
  <a href="/recommendations">📩 View Recommendations</a>
  <a href="/add-user">➕ Add User</a>
  <a href="/all-books">📚 All Books</a>
  <a href="/logout">🚪 Logout</a>
{% endblock %}
{% block content %}
    <h2>📚 All Books in Library</h2>

  <form method="get" class="row g-3 mt-2 mb-4">
    <div class="col-md-4">
      <input type="text" name="q" class="form-control" placeholder="Search by title, author, or keywords" value="{{ search }}">
    </div>
    <div class="col-md-2">
      <button type="submit" class="btn btn-primary">Search</button>
    </div>
  </form>

  {% if books.items %}
    <ul class="list-group">
      {% for book in books.items %}
        <li class="list-group-item">
          <strong>{{ book.title }}</strong> by {{ book.author }} <br>
          <em>Program:</em> {{ book.program }} | <em>Level:</em> {{ book.level }}<br>
          <em>Keywords:</em> {{ book.keywords }}
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No books found.</p>
  {% endif %}

  <!-- Pagination -->
  <nav aria-label="Page navigation" class="mt-4">
    <ul class="pagination">
      {% if books.has_prev %}
        <li class="page-item">
          <a class="page-link" href="?page={{ books.prev_num }}&q={{ search }}">← Previous</a>
        </li>
      {% endif %}

      {% for page_num in books.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
        {% if page_num %}
          <li class="page-item {% if page_num == books.page %}active{% endif %}">
            <a class="page-link" href="?page={{ page_num }}&q={{ search }}">{{ page_num }}</a>
          </li>
        {% else %}
          <li class="page-item disabled"><span class="page-link">…</span></li>
        {% endif %}
      {% endfor %}

      {% if books.has_next %}
        <li class="page-item">
          <a class="page-link" href="?page={{ books.next_num }}&q={{ search }}">Next →</a>
        </li>
      {% endif %}
    </ul>
  </nav>
  {% endblock %}
